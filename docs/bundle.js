/*! For license information please see bundle.js.LICENSE.txt */
(()=>{var t,r,e={56:(t,r,e)=>{"use strict";t.exports=function(t){var r=e.nc;r&&t.setAttribute("nonce",r)}},72:t=>{"use strict";var r=[];function e(t){for(var e=-1,n=0;n<r.length;n++)if(r[n].identifier===t){e=n;break}return e}function n(t,n){for(var i={},a=[],u=0;u<t.length;u++){var c=t[u],s=n.base?c[0]+n.base:c[0],f=i[s]||0,h="".concat(s," ").concat(f);i[s]=f+1;var l=e(h),p={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==l)r[l].references++,r[l].updater(p);else{var d=o(p,n);n.byIndex=u,r.splice(u,0,{identifier:h,updater:d,references:1})}a.push(h)}return a}function o(t,r){var e=r.domAPI(r);e.update(t);return function(r){if(r){if(r.css===t.css&&r.media===t.media&&r.sourceMap===t.sourceMap&&r.supports===t.supports&&r.layer===t.layer)return;e.update(t=r)}else e.remove()}}t.exports=function(t,o){var i=n(t=t||[],o=o||{});return function(t){t=t||[];for(var a=0;a<i.length;a++){var u=e(i[a]);r[u].references--}for(var c=n(t,o),s=0;s<i.length;s++){var f=e(i[s]);0===r[f].references&&(r[f].updater(),r.splice(f,1))}i=c}}},113:t=>{"use strict";t.exports=function(t,r){if(r.styleSheet)r.styleSheet.cssText=t;else{for(;r.firstChild;)r.removeChild(r.firstChild);r.appendChild(document.createTextNode(t))}}},276:(t,r,e)=>{"use strict";e.d(r,{A:()=>u});var n=e(601),o=e.n(n),i=e(314),a=e.n(i)()(o());a.push([t.id,"// extracted by mini-css-extract-plugin\nexport {};",""]);const u=a},314:t=>{"use strict";t.exports=function(t){var r=[];return r.toString=function(){return this.map((function(r){var e="",n=void 0!==r[5];return r[4]&&(e+="@supports (".concat(r[4],") {")),r[2]&&(e+="@media ".concat(r[2]," {")),n&&(e+="@layer".concat(r[5].length>0?" ".concat(r[5]):""," {")),e+=t(r),n&&(e+="}"),r[2]&&(e+="}"),r[4]&&(e+="}"),e})).join("")},r.i=function(t,e,n,o,i){"string"==typeof t&&(t=[[null,t,void 0]]);var a={};if(n)for(var u=0;u<this.length;u++){var c=this[u][0];null!=c&&(a[c]=!0)}for(var s=0;s<t.length;s++){var f=[].concat(t[s]);n&&a[f[0]]||(void 0!==i&&(void 0===f[5]||(f[1]="@layer".concat(f[5].length>0?" ".concat(f[5]):""," {").concat(f[1],"}")),f[5]=i),e&&(f[2]?(f[1]="@media ".concat(f[2]," {").concat(f[1],"}"),f[2]=e):f[2]=e),o&&(f[4]?(f[1]="@supports (".concat(f[4],") {").concat(f[1],"}"),f[4]=o):f[4]="".concat(o)),r.push(f))}},r}},518:()=>{"serviceWorker"in navigator&&window.addEventListener("load",(function(){navigator.serviceWorker.register("/sw.js").then((function(t){return console.log("[SW] Registered",t)})).catch((function(t){return console.error("[SW] Registration failed:",t)}))}))},540:t=>{"use strict";t.exports=function(t){var r=document.createElement("style");return t.setAttributes(r,t.attributes),t.insert(r,t.options),r}},601:t=>{"use strict";t.exports=function(t){return t[1]}},659:t=>{"use strict";var r={};t.exports=function(t,e){var n=function(t){if(void 0===r[t]){var e=document.querySelector(t);if(window.HTMLIFrameElement&&e instanceof window.HTMLIFrameElement)try{e=e.contentDocument.head}catch(t){e=null}r[t]=e}return r[t]}(t);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");n.appendChild(e)}},825:t=>{"use strict";t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var r=t.insertStyleElement(t);return{update:function(e){!function(t,r,e){var n="";e.supports&&(n+="@supports (".concat(e.supports,") {")),e.media&&(n+="@media ".concat(e.media," {"));var o=void 0!==e.layer;o&&(n+="@layer".concat(e.layer.length>0?" ".concat(e.layer):""," {")),n+=e.css,o&&(n+="}"),e.media&&(n+="}"),e.supports&&(n+="}");var i=e.sourceMap;i&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),r.styleTagTransform(n,t,r.options)}(r,t,e)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(r)}}}},891:(t,r,e)=>{"use strict";e.r(r),e.d(r,{clearOfflineStories:()=>f,deleteOfflineStoryDetail:()=>p,getAllOfflineStories:()=>c,getAllOfflineStoryDetails:()=>s,getOfflineStoryDetailById:()=>l,saveStoryDetailOffline:()=>h,saveStoryOffline:()=>u});var n="story-app",o=3,i="offline-submissions",a="story-details";function u(t){return t.description&&t.photo&&t.lat&&t.lon?new Promise((function(r,e){var a=indexedDB.open(n,o);a.onsuccess=function(){var n=a.result.transaction(i,"readwrite");n.objectStore(i).put(t),n.oncomplete=r,n.onerror=e},a.onerror=e})):(console.warn("Story tidak valid, tidak disimpan:",t),Promise.resolve())}function c(){return new Promise((function(t,r){var e=indexedDB.open(n,o);e.onsuccess=function(){var n=e.result.transaction(i,"readonly").objectStore(i).getAll();n.onsuccess=function(){return t(n.result)},n.onerror=r},e.onerror=r}))}function s(){return new Promise((function(t,r){var e=indexedDB.open(n,o);e.onsuccess=function(){var n=e.result.transaction(a,"readonly").objectStore(a).getAll();n.onsuccess=function(){return t(n.result)},n.onerror=r},e.onerror=r}))}function f(){return new Promise((function(t,r){var e=indexedDB.open(n,o);e.onsuccess=function(){var n=e.result.transaction(i,"readwrite").objectStore(i).clear();n.onsuccess=t,n.onerror=r},e.onerror=r}))}function h(t){return new Promise((function(r,e){var i=indexedDB.open(n,o);i.onsuccess=function(){var n=i.result.transaction(a,"readwrite");n.objectStore(a).put(t),n.oncomplete=r,n.onerror=e},i.onerror=e}))}function l(t){return new Promise((function(r,e){var i=indexedDB.open(n,o);i.onsuccess=function(){var n=i.result.transaction(a,"readonly").objectStore(a).get(t);n.onsuccess=function(){return r(n.result)},n.onerror=e},i.onerror=e}))}function p(t){return new Promise((function(r,e){var i=indexedDB.open(n,o);i.onsuccess=function(){var n=i.result.transaction(a,"readwrite").objectStore(a).delete(t);n.onsuccess=r,n.onerror=e},i.onerror=e}))}indexedDB.open(n,o).onupgradeneeded=function(t){var r=t.target.result;r.objectStoreNames.contains(i)&&r.deleteObjectStore(i),r.createObjectStore(i,{autoIncrement:!0}),r.objectStoreNames.contains(a)||r.createObjectStore(a,{keyPath:"id"})}}},n={};function o(t){var r=n[t];if(void 0!==r)return r.exports;var i=n[t]={id:t,exports:{}};return e[t](i,i.exports,o),i.exports}o.m=e,o.n=t=>{var r=t&&t.__esModule?()=>t.default:()=>t;return o.d(r,{a:r}),r},o.d=(t,r)=>{for(var e in r)o.o(r,e)&&!o.o(t,e)&&Object.defineProperty(t,e,{enumerable:!0,get:r[e]})},o.f={},o.e=t=>Promise.all(Object.keys(o.f).reduce(((r,e)=>(o.f[e](t,r),r)),[])),o.u=t=>t+".bundle.js",o.miniCssF=t=>{},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),o.o=(t,r)=>Object.prototype.hasOwnProperty.call(t,r),t={},r="story-app:",o.l=(e,n,i,a)=>{if(t[e])t[e].push(n);else{var u,c;if(void 0!==i)for(var s=document.getElementsByTagName("script"),f=0;f<s.length;f++){var h=s[f];if(h.getAttribute("src")==e||h.getAttribute("data-webpack")==r+i){u=h;break}}u||(c=!0,(u=document.createElement("script")).charset="utf-8",u.timeout=120,o.nc&&u.setAttribute("nonce",o.nc),u.setAttribute("data-webpack",r+i),u.src=e),t[e]=[n];var l=(r,n)=>{u.onerror=u.onload=null,clearTimeout(p);var o=t[e];if(delete t[e],u.parentNode&&u.parentNode.removeChild(u),o&&o.forEach((t=>t(n))),r)return r(n)},p=setTimeout(l.bind(null,void 0,{type:"timeout",target:u}),12e4);u.onerror=l.bind(null,u.onerror),u.onload=l.bind(null,u.onload),c&&document.head.appendChild(u)}},o.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t;o.g.importScripts&&(t=o.g.location+"");var r=o.g.document;if(!t&&r&&(r.currentScript&&"SCRIPT"===r.currentScript.tagName.toUpperCase()&&(t=r.currentScript.src),!t)){var e=r.getElementsByTagName("script");if(e.length)for(var n=e.length-1;n>-1&&(!t||!/^http(s?):/.test(t));)t=e[n--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),o.p=t})(),(()=>{var t={792:0};o.f.j=(r,e)=>{var n=o.o(t,r)?t[r]:void 0;if(0!==n)if(n)e.push(n[2]);else{var i=new Promise(((e,o)=>n=t[r]=[e,o]));e.push(n[2]=i);var a=o.p+o.u(r),u=new Error;o.l(a,(e=>{if(o.o(t,r)&&(0!==(n=t[r])&&(t[r]=void 0),n)){var i=e&&("load"===e.type?"missing":e.type),a=e&&e.target&&e.target.src;u.message="Loading chunk "+r+" failed.\n("+i+": "+a+")",u.name="ChunkLoadError",u.type=i,u.request=a,n[1](u)}}),"chunk-"+r,r)}};var r=(r,e)=>{var n,i,[a,u,c]=e,s=0;if(a.some((r=>0!==t[r]))){for(n in u)o.o(u,n)&&(o.m[n]=u[n]);if(c)c(o)}for(r&&r(e);s<a.length;s++)i=a[s],o.o(t,i)&&t[i]&&t[i][0](),t[i]=0},e=self.webpackChunkstory_app=self.webpackChunkstory_app||[];e.forEach(r.bind(null,0)),e.push=r.bind(null,e.push.bind(e))})(),o.nc=void 0,(()=>{"use strict";var t=o(891);function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function e(){e=function(){return n};var t,n={},o=Object.prototype,i=o.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},u=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function f(t,r,e,n){return Object.defineProperty(t,r,{value:e,enumerable:!n,configurable:!n,writable:!n})}try{f({},"")}catch(t){f=function(t,r,e){return t[r]=e}}function h(r,e,n,o){var i=e&&e.prototype instanceof d?e:d,a=Object.create(i.prototype);return f(a,"_invoke",function(r,e,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=k(u,n);if(c){if(c===p)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var s=l(r,e,n);if("normal"===s.type){if(o=n.done?4:2,s.arg===p)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=4,n.method="throw",n.arg=s.arg)}}}(r,n,new j(o||[])),!0),a}function l(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}n.wrap=h;var p={};function d(){}function y(){}function v(){}var g={};f(g,u,(function(){return this}));var m=Object.getPrototypeOf,w=m&&m(m(_([])));w&&w!==o&&i.call(w,u)&&(g=w);var b=v.prototype=d.prototype=Object.create(g);function x(t){["next","throw","return"].forEach((function(r){f(t,r,(function(t){return this._invoke(r,t)}))}))}function E(t,e){function n(o,a,u,c){var s=l(t[o],t,a);if("throw"!==s.type){var f=s.arg,h=f.value;return h&&"object"==r(h)&&i.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,u,c)}),(function(t){n("throw",t,u,c)})):e.resolve(h).then((function(t){f.value=t,u(f)}),(function(t){return n("throw",t,u,c)}))}c(s.arg)}var o;f(this,"_invoke",(function(t,r){function i(){return new e((function(e,o){n(t,r,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(r,e){var n=e.method,o=r.i[n];if(o===t)return e.delegate=null,"throw"===n&&r.i.return&&(e.method="return",e.arg=t,k(r,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var i=l(o,r.i,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,p;var a=i.arg;return a?a.done?(e[r.r]=a.value,e.next=r.n,"return"!==e.method&&(e.method="next",e.arg=t),e.delegate=null,p):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,p)}function S(t){this.tryEntries.push(t)}function O(r){var e=r[4]||{};e.type="normal",e.arg=t,r[4]=e}function j(t){this.tryEntries=[[-1]],t.forEach(S,this),this.reset(!0)}function _(e){if(null!=e){var n=e[u];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(i.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(r(e)+" is not iterable")}return y.prototype=v,f(b,"constructor",v),f(v,"constructor",y),y.displayName=f(v,s,"GeneratorFunction"),n.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===y||"GeneratorFunction"===(r.displayName||r.name))},n.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,f(t,s,"GeneratorFunction")),t.prototype=Object.create(b),t},n.awrap=function(t){return{__await:t}},x(E.prototype),f(E.prototype,c,(function(){return this})),n.AsyncIterator=E,n.async=function(t,r,e,o,i){void 0===i&&(i=Promise);var a=new E(h(t,r,e,o),i);return n.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},x(b),f(b,s,"Generator"),f(b,u,(function(){return this})),f(b,"toString",(function(){return"[object Generator]"})),n.keys=function(t){var r=Object(t),e=[];for(var n in r)e.unshift(n);return function t(){for(;e.length;)if((n=e.pop())in r)return t.value=n,t.done=!1,t;return t.done=!0,t}},n.values=_,j.prototype={constructor:j,reset:function(r){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!r)for(var e in this)"t"===e.charAt(0)&&i.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function n(t){a.type="throw",a.arg=r,e.next=t}for(var o=e.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,c=i[1],s=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!s)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<c)return this.method="next",this.arg=t,n(c),!0;if(u<s)return n(s),!1}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=r&&r<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=r,o?(this.method="next",this.next=o[2],p):this.complete(i)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),p},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e[2]===t)return this.complete(e[4],e[3]),O(e),p}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e[0]===t){var n=e[4];if("throw"===n.type){var o=n.arg;O(e)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,e,n){return this.delegate={i:_(r),r:e,n},"next"===this.method&&(this.arg=t),p}},n}function n(t,r,e,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void e(t)}u.done?r(c):Promise.resolve(c).then(n,o)}function i(t){return function(){var r=this,e=arguments;return new Promise((function(o,i){var a=t.apply(r,e);function u(t){n(a,o,i,u,c,"next",t)}function c(t){n(a,o,i,u,c,"throw",t)}u(void 0)}))}}var a={getAllStories:function(){return i(e().mark((function t(){var r,n,i,a;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(navigator.onLine){t.next=12;break}return console.warn("Offline mode: hanya menampilkan story yang dibookmark."),t.next=4,Promise.resolve().then(o.bind(o,891));case 4:return r=t.sent,n=r.getAllOfflineStoryDetails,t.next=8,n();case 8:if(t.t0=t.sent,t.t0){t.next=11;break}t.t0=[];case 11:return t.abrupt("return",t.t0);case 12:return t.prev=12,t.next=15,fetch("https://story-api.dicoding.dev/v1/stories",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});case 15:return i=t.sent,t.next=18,i.json();case 18:return a=t.sent,t.abrupt("return",a.listStory);case 22:return t.prev=22,t.t1=t.catch(12),console.error("Gagal fetch stories online:",t.t1),t.abrupt("return",[]);case 26:case"end":return t.stop()}}),t,null,[[12,22]])})))()},isBookmarked:function(t){return i(e().mark((function r(){var n,i,a;return e().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Promise.resolve().then(o.bind(o,891));case 2:return n=r.sent,i=n.getOfflineStoryDetailById,r.next=6,i(t);case 6:return a=r.sent,r.abrupt("return",!!a);case 8:case"end":return r.stop()}}),r)})))()},toggleBookmark:function(t){return i(e().mark((function r(){var n,i,a,u;return e().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Promise.resolve().then(o.bind(o,891));case 2:return n=r.sent,i=n.getOfflineStoryDetailById,a=n.deleteOfflineStoryDetail,u=n.saveStoryDetailOffline,r.next=8,i(t.id);case 8:if(!r.sent){r.next=15;break}return r.next=12,a(t.id);case 12:return r.abrupt("return",!1);case 15:return r.next=17,u(t);case 17:return r.abrupt("return",!0);case 18:case"end":return r.stop()}}),r)})))()},bindEvents:function(t){setTimeout((function(){var r,n,o;null===(r=document.getElementById("add-story"))||void 0===r||r.addEventListener("click",(function(){window.location.hash="/add-story"})),null===(n=document.getElementById("saved-stories"))||void 0===n||n.addEventListener("click",(function(){window.location.hash="/story-tersimpan"})),null===(o=document.getElementById("logout"))||void 0===o||o.addEventListener("click",(function(){localStorage.removeItem("token"),window.location.hash="/login"})),document.querySelectorAll(".bookmark-button").forEach((function(r){r.addEventListener("click",i(e().mark((function n(){var o,i,u;return e().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=r.dataset.id,i=t.find((function(t){return t.id==o}))){e.next=4;break}return e.abrupt("return");case 4:return e.prev=4,e.next=7,a.toggleBookmark(i);case 7:u=e.sent,r.textContent=u?"🔖 Buang":"🔖 Simpan",alert(u?"Story disimpan offline!":"Story dibuang dari offline."),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(4),console.error("Gagal toggle bookmark:",e.t0),alert("Terjadi kesalahan saat menyimpan/buang bookmark.");case 16:case"end":return e.stop()}}),n,null,[[4,12]])}))))}))}),0)},renderStoryMaps:function(t){setTimeout((function(){t.forEach((function(t,r){var e,n=t.lat,o=t.lon;if(n&&o){var i=document.getElementById("map-".concat(t.id||"offline-".concat(r)));if(i&&!i._leaflet_id){var a=L.map(i).setView([n,o],15);L.tileLayer("https://api.maptiler.com/maps/basic/{z}/{x}/{y}.png?key=7BXPo4DtwET5hku94tQR",{attribution:"&copy; OpenStreetMap contributors"}).addTo(a);var u=null!==(e=t.photoUrl)&&void 0!==e?e:t.photo instanceof File?URL.createObjectURL(t.photo):"string"==typeof t.photo&&t.photo.startsWith("data:image/")?t.photo:"";L.marker([n,o]).addTo(a).bindPopup('\n            <div style="font-size: 11px; max-width: 150px; padding: 5px; line-height: 1.3;">\n              <strong>'.concat(t.description,"</strong><br>\n              ").concat(u?'<img src="'.concat(u,'" alt="Foto cerita" style="width: 100%; height: auto; border-radius: 4px; margin-top: 4px;">'):"",'\n              <span style="color: #555;">').concat(n,", ").concat(o,"</span>\n            </div>\n          ")).openPopup()}}}))}),0)},bindPushToggle:function(){setTimeout((function(){var t=document.getElementById("push-toggle");if(t){var r=function(){var r=i(e().mark((function r(){var n,i,a;return e().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,o.e(374).then(o.bind(o,374));case 3:return n=r.sent,i=n.checkSubscription,r.next=7,i();case 7:a=r.sent,t.textContent=a?"🔕 Unsubscribe":"🔔 Subscribe",r.next=15;break;case 11:r.prev=11,r.t0=r.catch(0),console.error("Gagal memuat status notifikasi:",r.t0),t.textContent="🔔 Subscribe";case 15:case"end":return r.stop()}}),r,null,[[0,11]])})));return function(){return r.apply(this,arguments)}}();r(),t.addEventListener("click",i(e().mark((function t(){var n,i,a,u;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.e(374).then(o.bind(o,374));case 2:return n=t.sent,i=n.checkSubscription,a=n.subscribeUser,u=n.unsubscribeUser,t.prev=6,t.next=9,i();case 9:if(!t.sent){t.next=16;break}return t.next=13,u();case 13:alert("Berhasil unsubscribe notifikasi."),t.next=19;break;case 16:return t.next=18,a();case 18:alert("Berhasil subscribe notifikasi.");case 19:t.next=25;break;case 21:t.prev=21,t.t0=t.catch(6),console.error("Gagal toggle notifikasi:",t.t0),alert("Terjadi kesalahan saat toggle notifikasi.");case 25:r();case 26:case"end":return t.stop()}}),t,null,[[6,21]])}))))}}),0)}};function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function c(){c=function(){return r};var t,r={},e=Object.prototype,n=e.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function f(t,r,e,n){return Object.defineProperty(t,r,{value:e,enumerable:!n,configurable:!n,writable:!n})}try{f({},"")}catch(t){f=function(t,r,e){return t[r]=e}}function h(r,e,n,o){var i=e&&e.prototype instanceof d?e:d,a=Object.create(i.prototype);return f(a,"_invoke",function(r,e,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=k(u,n);if(c){if(c===p)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var s=l(r,e,n);if("normal"===s.type){if(o=n.done?4:2,s.arg===p)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=4,n.method="throw",n.arg=s.arg)}}}(r,n,new j(o||[])),!0),a}function l(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}r.wrap=h;var p={};function d(){}function y(){}function v(){}var g={};f(g,i,(function(){return this}));var m=Object.getPrototypeOf,w=m&&m(m(_([])));w&&w!==e&&n.call(w,i)&&(g=w);var b=v.prototype=d.prototype=Object.create(g);function x(t){["next","throw","return"].forEach((function(r){f(t,r,(function(t){return this._invoke(r,t)}))}))}function E(t,r){function e(o,i,a,c){var s=l(t[o],t,i);if("throw"!==s.type){var f=s.arg,h=f.value;return h&&"object"==u(h)&&n.call(h,"__await")?r.resolve(h.__await).then((function(t){e("next",t,a,c)}),(function(t){e("throw",t,a,c)})):r.resolve(h).then((function(t){f.value=t,a(f)}),(function(t){return e("throw",t,a,c)}))}c(s.arg)}var o;f(this,"_invoke",(function(t,n){function i(){return new r((function(r,o){e(t,n,r,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(r,e){var n=e.method,o=r.i[n];if(o===t)return e.delegate=null,"throw"===n&&r.i.return&&(e.method="return",e.arg=t,k(r,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var i=l(o,r.i,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,p;var a=i.arg;return a?a.done?(e[r.r]=a.value,e.next=r.n,"return"!==e.method&&(e.method="next",e.arg=t),e.delegate=null,p):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,p)}function S(t){this.tryEntries.push(t)}function O(r){var e=r[4]||{};e.type="normal",e.arg=t,r[4]=e}function j(t){this.tryEntries=[[-1]],t.forEach(S,this),this.reset(!0)}function _(r){if(null!=r){var e=r[i];if(e)return e.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,a=function e(){for(;++o<r.length;)if(n.call(r,o))return e.value=r[o],e.done=!1,e;return e.value=t,e.done=!0,e};return a.next=a}}throw new TypeError(u(r)+" is not iterable")}return y.prototype=v,f(b,"constructor",v),f(v,"constructor",y),y.displayName=f(v,s,"GeneratorFunction"),r.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===y||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,f(t,s,"GeneratorFunction")),t.prototype=Object.create(b),t},r.awrap=function(t){return{__await:t}},x(E.prototype),f(E.prototype,a,(function(){return this})),r.AsyncIterator=E,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new E(h(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},x(b),f(b,s,"Generator"),f(b,i,(function(){return this})),f(b,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var r=Object(t),e=[];for(var n in r)e.unshift(n);return function t(){for(;e.length;)if((n=e.pop())in r)return t.value=n,t.done=!1,t;return t.done=!0,t}},r.values=_,j.prototype={constructor:j,reset:function(r){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!r)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function n(t){a.type="throw",a.arg=r,e.next=t}for(var o=e.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,c=i[1],s=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!s)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<c)return this.method="next",this.arg=t,n(c),!0;if(u<s)return n(s),!1}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=r&&r<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=r,o?(this.method="next",this.next=o[2],p):this.complete(i)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),p},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e[2]===t)return this.complete(e[4],e[3]),O(e),p}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e[0]===t){var n=e[4];if("throw"===n.type){var o=n.arg;O(e)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,e,n){return this.delegate={i:_(r),r:e,n},"next"===this.method&&(this.arg=t),p}},r}function s(t,r,e,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void e(t)}u.done?r(c):Promise.resolve(c).then(n,o)}var f=function(){var t,r=(t=c().mark((function t(){var r,e,n,o,i;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.getAllStories();case 2:if(t.t0=t.sent,t.t0){t.next=5;break}t.t0=[];case 5:return r=t.t0,t.next=8,Promise.all(r.map((function(t){return!!t.id&&a.isBookmarked(t.id)})));case 8:return e=t.sent,n="",r.forEach((function(t,r){var o,i=null!==(o=t.photoUrl)&&void 0!==o?o:t.photo instanceof File?URL.createObjectURL(t.photo):"string"==typeof t.photo&&t.photo.startsWith("data:image/")?t.photo:"https://via.placeholder.com/300x200?text=No+Image",a=t.createdAt?new Date(t.createdAt).toLocaleDateString():"Offline Story",u="map-".concat(t.id||"offline-".concat(r)),c='<span style="color:#888;">(Offline story)</span>';if(t.id){var s=e[r]?"🔖 Buang":"🔖 Simpan";c='\n        <a href="#/story/'.concat(t.id,'">See Details</a>\n        <button class="bookmark-button" data-id="').concat(t.id,'">\n          ').concat(s,"\n        </button>\n      ")}n+='\n      <div class="story-item fade-in">\n        <img src="'.concat(i,'" alt="Foto cerita: ').concat(t.description,'">\n        <p>').concat(t.description,"</p>\n        <p><strong>Location:</strong> ").concat(t.lat||"-",", ").concat(t.lon||"-","</p>\n        <p><strong>Created At:</strong> ").concat(a,'</p>\n        <div id="').concat(u,'" class="story-map" style="height: 300px;"></div>\n        ').concat(c,"\n      </div>\n    ")})),o='\n    <h2 class="fade-in home-header">\n      <span>Home Page</span>\n      <button id="push-toggle" class="push-toggle-button">🔔 Subscribe</button>\n    </h2>\n    <div class="home-buttons fade-in">\n      <button id="add-story" class="fade-in">Tambah Data</button>\n      <button id="saved-stories" class="fade-in">Story Tersimpan</button>\n      <button id="logout" class="fade-in">Logout</button>\n    </div>\n    <div id="stories-list" class="fade-in">'.concat(n,"</div>\n  "),(i=document.getElementById("home-container"))&&(i.innerHTML=o),a.bindEvents(r),a.renderStoryMaps(r),a.bindPushToggle(),t.abrupt("return",o);case 18:case"end":return t.stop()}}),t)})),function(){var r=this,e=arguments;return new Promise((function(n,o){var i=t.apply(r,e);function a(t){s(i,n,o,a,u,"next",t)}function u(t){s(i,n,o,a,u,"throw",t)}a(void 0)}))});return function(){return r.apply(this,arguments)}}();function h(t){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h(t)}function l(){l=function(){return r};var t,r={},e=Object.prototype,n=e.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(t,r,e,n){return Object.defineProperty(t,r,{value:e,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(t){c=function(t,r,e){return t[r]=e}}function s(r,e,n,o){var i=e&&e.prototype instanceof d?e:d,a=Object.create(i.prototype);return c(a,"_invoke",function(r,e,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=k(u,n);if(c){if(c===p)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var s=f(r,e,n);if("normal"===s.type){if(o=n.done?4:2,s.arg===p)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=4,n.method="throw",n.arg=s.arg)}}}(r,n,new j(o||[])),!0),a}function f(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}r.wrap=s;var p={};function d(){}function y(){}function v(){}var g={};c(g,i,(function(){return this}));var m=Object.getPrototypeOf,w=m&&m(m(_([])));w&&w!==e&&n.call(w,i)&&(g=w);var b=v.prototype=d.prototype=Object.create(g);function x(t){["next","throw","return"].forEach((function(r){c(t,r,(function(t){return this._invoke(r,t)}))}))}function E(t,r){function e(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==h(l)&&n.call(l,"__await")?r.resolve(l.__await).then((function(t){e("next",t,a,u)}),(function(t){e("throw",t,a,u)})):r.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return e("throw",t,a,u)}))}u(c.arg)}var o;c(this,"_invoke",(function(t,n){function i(){return new r((function(r,o){e(t,n,r,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(r,e){var n=e.method,o=r.i[n];if(o===t)return e.delegate=null,"throw"===n&&r.i.return&&(e.method="return",e.arg=t,k(r,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var i=f(o,r.i,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,p;var a=i.arg;return a?a.done?(e[r.r]=a.value,e.next=r.n,"return"!==e.method&&(e.method="next",e.arg=t),e.delegate=null,p):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,p)}function S(t){this.tryEntries.push(t)}function O(r){var e=r[4]||{};e.type="normal",e.arg=t,r[4]=e}function j(t){this.tryEntries=[[-1]],t.forEach(S,this),this.reset(!0)}function _(r){if(null!=r){var e=r[i];if(e)return e.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,a=function e(){for(;++o<r.length;)if(n.call(r,o))return e.value=r[o],e.done=!1,e;return e.value=t,e.done=!0,e};return a.next=a}}throw new TypeError(h(r)+" is not iterable")}return y.prototype=v,c(b,"constructor",v),c(v,"constructor",y),y.displayName=c(v,u,"GeneratorFunction"),r.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===y||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,c(t,u,"GeneratorFunction")),t.prototype=Object.create(b),t},r.awrap=function(t){return{__await:t}},x(E.prototype),c(E.prototype,a,(function(){return this})),r.AsyncIterator=E,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new E(s(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},x(b),c(b,u,"Generator"),c(b,i,(function(){return this})),c(b,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var r=Object(t),e=[];for(var n in r)e.unshift(n);return function t(){for(;e.length;)if((n=e.pop())in r)return t.value=n,t.done=!1,t;return t.done=!0,t}},r.values=_,j.prototype={constructor:j,reset:function(r){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!r)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function n(t){a.type="throw",a.arg=r,e.next=t}for(var o=e.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,c=i[1],s=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!s)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<c)return this.method="next",this.arg=t,n(c),!0;if(u<s)return n(s),!1}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=r&&r<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=r,o?(this.method="next",this.next=o[2],p):this.complete(i)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),p},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e[2]===t)return this.complete(e[4],e[3]),O(e),p}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e[0]===t){var n=e[4];if("throw"===n.type){var o=n.arg;O(e)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,e,n){return this.delegate={i:_(r),r:e,n},"next"===this.method&&(this.arg=t),p}},r}function p(t,r,e,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void e(t)}u.done?r(c):Promise.resolve(c).then(n,o)}function d(t){return function(){var r=this,e=arguments;return new Promise((function(n,o){var i=t.apply(r,e);function a(t){p(i,n,o,a,u,"next",t)}function u(t){p(i,n,o,a,u,"throw",t)}a(void 0)}))}}var y="https://story-api.dicoding.dev/v1",v=function(t){return d(l().mark((function r(){var e,n,o,i,a;return l().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return e=t.name,n=t.email,o=t.password,r.next=3,fetch("https://story-api.dicoding.dev/v1/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,email:n,password:o})});case 3:return i=r.sent,r.next=6,i.json();case 6:if(a=r.sent,console.log("Register response:",a),i.ok){r.next=10;break}throw new Error(a.message||"Register failed");case 10:case"end":return r.stop()}}),r)})))()},g=function(t){return d(l().mark((function r(){var e,n,o,i;return l().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return e=t.email,n=t.password,r.next=3,fetch("".concat(y,"/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:n})});case 3:return o=r.sent,r.next=6,o.json();case 6:return i=r.sent,r.abrupt("return",i.loginResult);case 8:case"end":return r.stop()}}),r)})))()},m=function(t){return d(l().mark((function r(){var e,n,o,i,a,u,c;return l().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return e=t.description,n=t.photo,o=t.lat,i=t.lon,a=localStorage.getItem("token"),(u=new FormData).append("description",e),u.append("photo",n),u.append("lat",o),u.append("lon",i),r.next=9,fetch("".concat(y,"/stories"),{method:"POST",headers:{Authorization:"Bearer ".concat(a)},body:u});case 9:return c=r.sent,r.next=12,c.json();case 12:return r.abrupt("return",r.sent);case 13:case"end":return r.stop()}}),r)})))()};function w(t){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},w(t)}function b(){b=function(){return r};var t,r={},e=Object.prototype,n=e.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(t,r,e,n){return Object.defineProperty(t,r,{value:e,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(t){c=function(t,r,e){return t[r]=e}}function s(r,e,n,o){var i=e&&e.prototype instanceof l?e:l,a=Object.create(i.prototype);return c(a,"_invoke",function(r,e,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=k(u,n);if(c){if(c===h)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var s=f(r,e,n);if("normal"===s.type){if(o=n.done?4:2,s.arg===h)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=4,n.method="throw",n.arg=s.arg)}}}(r,n,new j(o||[])),!0),a}function f(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}r.wrap=s;var h={};function l(){}function p(){}function d(){}var y={};c(y,i,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(_([])));g&&g!==e&&n.call(g,i)&&(y=g);var m=d.prototype=l.prototype=Object.create(y);function x(t){["next","throw","return"].forEach((function(r){c(t,r,(function(t){return this._invoke(r,t)}))}))}function E(t,r){function e(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,h=s.value;return h&&"object"==w(h)&&n.call(h,"__await")?r.resolve(h.__await).then((function(t){e("next",t,a,u)}),(function(t){e("throw",t,a,u)})):r.resolve(h).then((function(t){s.value=t,a(s)}),(function(t){return e("throw",t,a,u)}))}u(c.arg)}var o;c(this,"_invoke",(function(t,n){function i(){return new r((function(r,o){e(t,n,r,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(r,e){var n=e.method,o=r.i[n];if(o===t)return e.delegate=null,"throw"===n&&r.i.return&&(e.method="return",e.arg=t,k(r,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=f(o,r.i,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,h;var a=i.arg;return a?a.done?(e[r.r]=a.value,e.next=r.n,"return"!==e.method&&(e.method="next",e.arg=t),e.delegate=null,h):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function S(t){this.tryEntries.push(t)}function O(r){var e=r[4]||{};e.type="normal",e.arg=t,r[4]=e}function j(t){this.tryEntries=[[-1]],t.forEach(S,this),this.reset(!0)}function _(r){if(null!=r){var e=r[i];if(e)return e.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,a=function e(){for(;++o<r.length;)if(n.call(r,o))return e.value=r[o],e.done=!1,e;return e.value=t,e.done=!0,e};return a.next=a}}throw new TypeError(w(r)+" is not iterable")}return p.prototype=d,c(m,"constructor",d),c(d,"constructor",p),p.displayName=c(d,u,"GeneratorFunction"),r.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===p||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,c(t,u,"GeneratorFunction")),t.prototype=Object.create(m),t},r.awrap=function(t){return{__await:t}},x(E.prototype),c(E.prototype,a,(function(){return this})),r.AsyncIterator=E,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new E(s(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},x(m),c(m,u,"Generator"),c(m,i,(function(){return this})),c(m,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var r=Object(t),e=[];for(var n in r)e.unshift(n);return function t(){for(;e.length;)if((n=e.pop())in r)return t.value=n,t.done=!1,t;return t.done=!0,t}},r.values=_,j.prototype={constructor:j,reset:function(r){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!r)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function n(t){a.type="throw",a.arg=r,e.next=t}for(var o=e.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,c=i[1],s=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!s)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<c)return this.method="next",this.arg=t,n(c),!0;if(u<s)return n(s),!1}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=r&&r<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=r,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),h},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e[2]===t)return this.complete(e[4],e[3]),O(e),h}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e[0]===t){var n=e[4];if("throw"===n.type){var o=n.arg;O(e)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,e,n){return this.delegate={i:_(r),r:e,n},"next"===this.method&&(this.arg=t),h}},r}function x(t,r,e,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void e(t)}u.done?r(c):Promise.resolve(c).then(n,o)}function E(t){return function(){var r=this,e=arguments;return new Promise((function(n,o){var i=t.apply(r,e);function a(t){x(i,n,o,a,u,"next",t)}function u(t){x(i,n,o,a,u,"throw",t)}a(void 0)}))}}var k=function(t,r,e){return E(b().mark((function n(){return b().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,v({name:t,email:r,password:e});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}}),n)})))()},S=function(t,r){return E(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g({email:t,password:r});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))()},O=function(t,r,e,n){return E(b().mark((function o(){return b().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,m({description:t,photo:r,lat:e,lon:n});case 2:return o.abrupt("return",o.sent);case 3:case"end":return o.stop()}}),o)})))()};function j(t){return j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},j(t)}function _(t,r){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,r){if(t){if("string"==typeof t)return P(t,r);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?P(t,r):void 0}}(t))||r&&t&&"number"==typeof t.length){e&&(t=e);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw i}}}}function P(t,r){(null==r||r>t.length)&&(r=t.length);for(var e=0,n=Array(r);e<r;e++)n[e]=t[e];return n}function T(){T=function(){return r};var t,r={},e=Object.prototype,n=e.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(t,r,e,n){return Object.defineProperty(t,r,{value:e,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(t){c=function(t,r,e){return t[r]=e}}function s(r,e,n,o){var i=e&&e.prototype instanceof l?e:l,a=Object.create(i.prototype);return c(a,"_invoke",function(r,e,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=x(u,n);if(c){if(c===h)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var s=f(r,e,n);if("normal"===s.type){if(o=n.done?4:2,s.arg===h)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=4,n.method="throw",n.arg=s.arg)}}}(r,n,new S(o||[])),!0),a}function f(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}r.wrap=s;var h={};function l(){}function p(){}function d(){}var y={};c(y,i,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(O([])));g&&g!==e&&n.call(g,i)&&(y=g);var m=d.prototype=l.prototype=Object.create(y);function w(t){["next","throw","return"].forEach((function(r){c(t,r,(function(t){return this._invoke(r,t)}))}))}function b(t,r){function e(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,h=s.value;return h&&"object"==j(h)&&n.call(h,"__await")?r.resolve(h.__await).then((function(t){e("next",t,a,u)}),(function(t){e("throw",t,a,u)})):r.resolve(h).then((function(t){s.value=t,a(s)}),(function(t){return e("throw",t,a,u)}))}u(c.arg)}var o;c(this,"_invoke",(function(t,n){function i(){return new r((function(r,o){e(t,n,r,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(r,e){var n=e.method,o=r.i[n];if(o===t)return e.delegate=null,"throw"===n&&r.i.return&&(e.method="return",e.arg=t,x(r,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=f(o,r.i,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,h;var a=i.arg;return a?a.done?(e[r.r]=a.value,e.next=r.n,"return"!==e.method&&(e.method="next",e.arg=t),e.delegate=null,h):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function E(t){this.tryEntries.push(t)}function k(r){var e=r[4]||{};e.type="normal",e.arg=t,r[4]=e}function S(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function O(r){if(null!=r){var e=r[i];if(e)return e.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,a=function e(){for(;++o<r.length;)if(n.call(r,o))return e.value=r[o],e.done=!1,e;return e.value=t,e.done=!0,e};return a.next=a}}throw new TypeError(j(r)+" is not iterable")}return p.prototype=d,c(m,"constructor",d),c(d,"constructor",p),p.displayName=c(d,u,"GeneratorFunction"),r.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===p||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,c(t,u,"GeneratorFunction")),t.prototype=Object.create(m),t},r.awrap=function(t){return{__await:t}},w(b.prototype),c(b.prototype,a,(function(){return this})),r.AsyncIterator=b,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new b(s(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(m),c(m,u,"Generator"),c(m,i,(function(){return this})),c(m,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var r=Object(t),e=[];for(var n in r)e.unshift(n);return function t(){for(;e.length;)if((n=e.pop())in r)return t.value=n,t.done=!1,t;return t.done=!0,t}},r.values=O,S.prototype={constructor:S,reset:function(r){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!r)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function n(t){a.type="throw",a.arg=r,e.next=t}for(var o=e.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,c=i[1],s=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!s)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<c)return this.method="next",this.arg=t,n(c),!0;if(u<s)return n(s),!1}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=r&&r<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=r,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),h},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e[2]===t)return this.complete(e[4],e[3]),k(e),h}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e[0]===t){var n=e[4];if("throw"===n.type){var o=n.arg;k(e)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,e,n){return this.delegate={i:O(r),r:e,n},"next"===this.method&&(this.arg=t),h}},r}function G(t,r,e,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void e(t)}u.done?r(c):Promise.resolve(c).then(n,o)}function N(t){return function(){var r=this,e=arguments;return new Promise((function(n,o){var i=t.apply(r,e);function a(t){G(i,n,o,a,u,"next",t)}function u(t){G(i,n,o,a,u,"throw",t)}a(void 0)}))}}var F=function(r){return N(T().mark((function e(){var n,o,i,a;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.description,o=r.photo,i=r.lat,a=r.lon,navigator.onLine){e.next=7;break}return e.next=4,(0,t.saveStoryOffline)({description:n,photo:o,lat:i,lon:a});case 4:return e.abrupt("return",{offline:!0});case 7:return e.next=9,O(n,o,i,a);case 9:return e.abrupt("return",{offline:!1});case 10:case"end":return e.stop()}}),e)})))()},I=function(){return N(T().mark((function r(){var e,n,o,i,a,u;return T().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,t.getAllOfflineStories)();case 2:e=r.sent,n=_(e),r.prev=4,n.s();case 6:if((o=n.n()).done){r.next=22;break}if(i=o.value,r.prev=8,i.description&&(i.photo||i.photoUrl)){r.next=11;break}return r.abrupt("continue",20);case 11:return a=i.photo,u=new File([a],"offline-photo.jpg",{type:a.type||"image/jpeg"}),r.next=15,O(i.description,u,i.lat,i.lon);case 15:r.next=20;break;case 17:r.prev=17,r.t0=r.catch(8),console.error("Gagal sinkronisasi cerita offline:",r.t0);case 20:r.next=6;break;case 22:r.next=27;break;case 24:r.prev=24,r.t1=r.catch(4),n.e(r.t1);case 27:return r.prev=27,n.f(),r.finish(27);case 30:return r.next=32,(0,t.clearOfflineStories)();case 32:case"end":return r.stop()}}),r,null,[[4,24,27,30],[8,17]])})))()};function A(t){return A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},A(t)}function B(){B=function(){return r};var t,r={},e=Object.prototype,n=e.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(t,r,e,n){return Object.defineProperty(t,r,{value:e,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(t){c=function(t,r,e){return t[r]=e}}function s(r,e,n,o){var i=e&&e.prototype instanceof l?e:l,a=Object.create(i.prototype);return c(a,"_invoke",function(r,e,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=x(u,n);if(c){if(c===h)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var s=f(r,e,n);if("normal"===s.type){if(o=n.done?4:2,s.arg===h)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=4,n.method="throw",n.arg=s.arg)}}}(r,n,new S(o||[])),!0),a}function f(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}r.wrap=s;var h={};function l(){}function p(){}function d(){}var y={};c(y,i,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(O([])));g&&g!==e&&n.call(g,i)&&(y=g);var m=d.prototype=l.prototype=Object.create(y);function w(t){["next","throw","return"].forEach((function(r){c(t,r,(function(t){return this._invoke(r,t)}))}))}function b(t,r){function e(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,h=s.value;return h&&"object"==A(h)&&n.call(h,"__await")?r.resolve(h.__await).then((function(t){e("next",t,a,u)}),(function(t){e("throw",t,a,u)})):r.resolve(h).then((function(t){s.value=t,a(s)}),(function(t){return e("throw",t,a,u)}))}u(c.arg)}var o;c(this,"_invoke",(function(t,n){function i(){return new r((function(r,o){e(t,n,r,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(r,e){var n=e.method,o=r.i[n];if(o===t)return e.delegate=null,"throw"===n&&r.i.return&&(e.method="return",e.arg=t,x(r,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=f(o,r.i,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,h;var a=i.arg;return a?a.done?(e[r.r]=a.value,e.next=r.n,"return"!==e.method&&(e.method="next",e.arg=t),e.delegate=null,h):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function E(t){this.tryEntries.push(t)}function k(r){var e=r[4]||{};e.type="normal",e.arg=t,r[4]=e}function S(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function O(r){if(null!=r){var e=r[i];if(e)return e.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,a=function e(){for(;++o<r.length;)if(n.call(r,o))return e.value=r[o],e.done=!1,e;return e.value=t,e.done=!0,e};return a.next=a}}throw new TypeError(A(r)+" is not iterable")}return p.prototype=d,c(m,"constructor",d),c(d,"constructor",p),p.displayName=c(d,u,"GeneratorFunction"),r.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===p||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,c(t,u,"GeneratorFunction")),t.prototype=Object.create(m),t},r.awrap=function(t){return{__await:t}},w(b.prototype),c(b.prototype,a,(function(){return this})),r.AsyncIterator=b,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new b(s(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(m),c(m,u,"Generator"),c(m,i,(function(){return this})),c(m,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var r=Object(t),e=[];for(var n in r)e.unshift(n);return function t(){for(;e.length;)if((n=e.pop())in r)return t.value=n,t.done=!1,t;return t.done=!0,t}},r.values=O,S.prototype={constructor:S,reset:function(r){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!r)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function n(t){a.type="throw",a.arg=r,e.next=t}for(var o=e.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,c=i[1],s=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!s)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<c)return this.method="next",this.arg=t,n(c),!0;if(u<s)return n(s),!1}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=r&&r<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=r,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),h},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e[2]===t)return this.complete(e[4],e[3]),k(e),h}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e[0]===t){var n=e[4];if("throw"===n.type){var o=n.arg;k(e)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,e,n){return this.delegate={i:O(r),r:e,n},"next"===this.method&&(this.arg=t),h}},r}function D(t,r,e,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void e(t)}u.done?r(c):Promise.resolve(c).then(n,o)}function C(t){return function(){var r=this,e=arguments;return new Promise((function(n,o){var i=t.apply(r,e);function a(t){D(i,n,o,a,u,"next",t)}function u(t){D(i,n,o,a,u,"throw",t)}a(void 0)}))}}function U(t){return U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},U(t)}function M(){M=function(){return r};var t,r={},e=Object.prototype,n=e.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(t,r,e,n){return Object.defineProperty(t,r,{value:e,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(t){c=function(t,r,e){return t[r]=e}}function s(r,e,n,o){var i=e&&e.prototype instanceof l?e:l,a=Object.create(i.prototype);return c(a,"_invoke",function(r,e,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=x(u,n);if(c){if(c===h)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var s=f(r,e,n);if("normal"===s.type){if(o=n.done?4:2,s.arg===h)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=4,n.method="throw",n.arg=s.arg)}}}(r,n,new S(o||[])),!0),a}function f(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}r.wrap=s;var h={};function l(){}function p(){}function d(){}var y={};c(y,i,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(O([])));g&&g!==e&&n.call(g,i)&&(y=g);var m=d.prototype=l.prototype=Object.create(y);function w(t){["next","throw","return"].forEach((function(r){c(t,r,(function(t){return this._invoke(r,t)}))}))}function b(t,r){function e(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,h=s.value;return h&&"object"==U(h)&&n.call(h,"__await")?r.resolve(h.__await).then((function(t){e("next",t,a,u)}),(function(t){e("throw",t,a,u)})):r.resolve(h).then((function(t){s.value=t,a(s)}),(function(t){return e("throw",t,a,u)}))}u(c.arg)}var o;c(this,"_invoke",(function(t,n){function i(){return new r((function(r,o){e(t,n,r,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(r,e){var n=e.method,o=r.i[n];if(o===t)return e.delegate=null,"throw"===n&&r.i.return&&(e.method="return",e.arg=t,x(r,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=f(o,r.i,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,h;var a=i.arg;return a?a.done?(e[r.r]=a.value,e.next=r.n,"return"!==e.method&&(e.method="next",e.arg=t),e.delegate=null,h):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function E(t){this.tryEntries.push(t)}function k(r){var e=r[4]||{};e.type="normal",e.arg=t,r[4]=e}function S(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function O(r){if(null!=r){var e=r[i];if(e)return e.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,a=function e(){for(;++o<r.length;)if(n.call(r,o))return e.value=r[o],e.done=!1,e;return e.value=t,e.done=!0,e};return a.next=a}}throw new TypeError(U(r)+" is not iterable")}return p.prototype=d,c(m,"constructor",d),c(d,"constructor",p),p.displayName=c(d,u,"GeneratorFunction"),r.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===p||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,c(t,u,"GeneratorFunction")),t.prototype=Object.create(m),t},r.awrap=function(t){return{__await:t}},w(b.prototype),c(b.prototype,a,(function(){return this})),r.AsyncIterator=b,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new b(s(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(m),c(m,u,"Generator"),c(m,i,(function(){return this})),c(m,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var r=Object(t),e=[];for(var n in r)e.unshift(n);return function t(){for(;e.length;)if((n=e.pop())in r)return t.value=n,t.done=!1,t;return t.done=!0,t}},r.values=O,S.prototype={constructor:S,reset:function(r){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!r)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function n(t){a.type="throw",a.arg=r,e.next=t}for(var o=e.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,c=i[1],s=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!s)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<c)return this.method="next",this.arg=t,n(c),!0;if(u<s)return n(s),!1}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=r&&r<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=r,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),h},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e[2]===t)return this.complete(e[4],e[3]),k(e),h}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e[0]===t){var n=e[4];if("throw"===n.type){var o=n.arg;k(e)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,e,n){return this.delegate={i:O(r),r:e,n},"next"===this.method&&(this.arg=t),h}},r}function R(t,r,e,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void e(t)}u.done?r(c):Promise.resolve(c).then(n,o)}var Y=function(r){return(e=M().mark((function e(){var n,o,i;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://story-api.dicoding.dev/v1/stories/".concat(r),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});case 3:return o=e.sent,e.next=6,o.json();case 6:if(null==(i=e.sent)||null===(n=i.story)||void 0===n||!n.id){e.next=10;break}return e.next=10,(0,t.saveStoryDetailOffline)(i.story);case 10:return e.abrupt("return",i.story);case 13:return e.prev=13,e.t0=e.catch(0),console.warn("[Offline Mode] Mengambil detail dari cache untuk id:",r),e.next=18,(0,t.getOfflineStoryDetailById)(r);case 18:return e.abrupt("return",e.sent);case 19:case"end":return e.stop()}}),e,null,[[0,13]])})),function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(t){R(i,n,o,a,u,"next",t)}function u(t){R(i,n,o,a,u,"throw",t)}a(void 0)}))})();var e};function q(t){return q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},q(t)}function H(){H=function(){return r};var t,r={},e=Object.prototype,n=e.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(t,r,e,n){return Object.defineProperty(t,r,{value:e,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(t){c=function(t,r,e){return t[r]=e}}function s(r,e,n,o){var i=e&&e.prototype instanceof l?e:l,a=Object.create(i.prototype);return c(a,"_invoke",function(r,e,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=x(u,n);if(c){if(c===h)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var s=f(r,e,n);if("normal"===s.type){if(o=n.done?4:2,s.arg===h)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=4,n.method="throw",n.arg=s.arg)}}}(r,n,new S(o||[])),!0),a}function f(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}r.wrap=s;var h={};function l(){}function p(){}function d(){}var y={};c(y,i,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(O([])));g&&g!==e&&n.call(g,i)&&(y=g);var m=d.prototype=l.prototype=Object.create(y);function w(t){["next","throw","return"].forEach((function(r){c(t,r,(function(t){return this._invoke(r,t)}))}))}function b(t,r){function e(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,h=s.value;return h&&"object"==q(h)&&n.call(h,"__await")?r.resolve(h.__await).then((function(t){e("next",t,a,u)}),(function(t){e("throw",t,a,u)})):r.resolve(h).then((function(t){s.value=t,a(s)}),(function(t){return e("throw",t,a,u)}))}u(c.arg)}var o;c(this,"_invoke",(function(t,n){function i(){return new r((function(r,o){e(t,n,r,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(r,e){var n=e.method,o=r.i[n];if(o===t)return e.delegate=null,"throw"===n&&r.i.return&&(e.method="return",e.arg=t,x(r,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=f(o,r.i,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,h;var a=i.arg;return a?a.done?(e[r.r]=a.value,e.next=r.n,"return"!==e.method&&(e.method="next",e.arg=t),e.delegate=null,h):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function E(t){this.tryEntries.push(t)}function k(r){var e=r[4]||{};e.type="normal",e.arg=t,r[4]=e}function S(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function O(r){if(null!=r){var e=r[i];if(e)return e.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,a=function e(){for(;++o<r.length;)if(n.call(r,o))return e.value=r[o],e.done=!1,e;return e.value=t,e.done=!0,e};return a.next=a}}throw new TypeError(q(r)+" is not iterable")}return p.prototype=d,c(m,"constructor",d),c(d,"constructor",p),p.displayName=c(d,u,"GeneratorFunction"),r.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===p||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,c(t,u,"GeneratorFunction")),t.prototype=Object.create(m),t},r.awrap=function(t){return{__await:t}},w(b.prototype),c(b.prototype,a,(function(){return this})),r.AsyncIterator=b,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new b(s(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(m),c(m,u,"Generator"),c(m,i,(function(){return this})),c(m,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var r=Object(t),e=[];for(var n in r)e.unshift(n);return function t(){for(;e.length;)if((n=e.pop())in r)return t.value=n,t.done=!1,t;return t.done=!0,t}},r.values=O,S.prototype={constructor:S,reset:function(r){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!r)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function n(t){a.type="throw",a.arg=r,e.next=t}for(var o=e.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,c=i[1],s=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!s)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<c)return this.method="next",this.arg=t,n(c),!0;if(u<s)return n(s),!1}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=r&&r<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=r,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),h},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e[2]===t)return this.complete(e[4],e[3]),k(e),h}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e[0]===t){var n=e[4];if("throw"===n.type){var o=n.arg;k(e)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,e,n){return this.delegate={i:O(r),r:e,n},"next"===this.method&&(this.arg=t),h}},r}function z(t,r,e,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void e(t)}u.done?r(c):Promise.resolve(c).then(n,o)}var W=function(){var t,r=(t=H().mark((function t(r){var e,n,o,i,a,u,c;return H().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Y(r);case 2:if(t.t0=t.sent,t.t0){t.next=5;break}t.t0={};case 5:return n=t.t0,o=null!==(e=n.description)&&void 0!==e?e:"Tidak tersedia",i=void 0===n.lat||isNaN(parseFloat(n.lat))?null:parseFloat(n.lat),a=void 0===n.lon||isNaN(parseFloat(n.lon))?null:parseFloat(n.lon),!(u=n.photoUrl)&&n.photo instanceof Blob&&(u=URL.createObjectURL(n.photo)),u||(u="/assets/images/fallback.png"),c='\n        <div class="detail-container">\n            <h2>Story Detail</h2>\n            <div class="story-detail">\n                <img class="story-img" src="'.concat(u,'" alt="Story photo" />\n                <div class="story-info">\n                    <p>').concat(o,"</p>\n                    <p><strong>Location:</strong> Latitude: ").concat(null!=i?i:"-",", Longitude: ").concat(null!=a?a:"-",'</p>\n                </div>\n                <div id="story-map" class="story-map" style="height: 300px;"></div>\n                <a href="#/" class="back-btn">← Back to Home</a>\n            </div>\n        </div>\n    '),setTimeout((function(){var t=document.getElementById("story-map");if(t&&!t._leaflet_id&&null!==i&&null!==a){var r=L.map(t).setView([i,a],13);L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors'}).addTo(r),L.marker([i,a]).addTo(r).bindPopup("<b>Your Story Location</b>").openPopup()}else console.warn("[DetailView] Map tidak dirender karena koordinat tidak valid:",i,a)}),100),t.abrupt("return",c);case 15:case"end":return t.stop()}}),t)})),function(){var r=this,e=arguments;return new Promise((function(n,o){var i=t.apply(r,e);function a(t){z(i,n,o,a,u,"next",t)}function u(t){z(i,n,o,a,u,"throw",t)}a(void 0)}))});return function(t){return r.apply(this,arguments)}}();function K(t){return K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},K(t)}function $(t,r){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,r){if(t){if("string"==typeof t)return V(t,r);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?V(t,r):void 0}}(t))||r&&t&&"number"==typeof t.length){e&&(t=e);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw i}}}}function V(t,r){(null==r||r>t.length)&&(r=t.length);for(var e=0,n=Array(r);e<r;e++)n[e]=t[e];return n}function J(){J=function(){return r};var t,r={},e=Object.prototype,n=e.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(t,r,e,n){return Object.defineProperty(t,r,{value:e,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(t){c=function(t,r,e){return t[r]=e}}function s(r,e,n,o){var i=e&&e.prototype instanceof l?e:l,a=Object.create(i.prototype);return c(a,"_invoke",function(r,e,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=x(u,n);if(c){if(c===h)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var s=f(r,e,n);if("normal"===s.type){if(o=n.done?4:2,s.arg===h)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=4,n.method="throw",n.arg=s.arg)}}}(r,n,new S(o||[])),!0),a}function f(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}r.wrap=s;var h={};function l(){}function p(){}function d(){}var y={};c(y,i,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(O([])));g&&g!==e&&n.call(g,i)&&(y=g);var m=d.prototype=l.prototype=Object.create(y);function w(t){["next","throw","return"].forEach((function(r){c(t,r,(function(t){return this._invoke(r,t)}))}))}function b(t,r){function e(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,h=s.value;return h&&"object"==K(h)&&n.call(h,"__await")?r.resolve(h.__await).then((function(t){e("next",t,a,u)}),(function(t){e("throw",t,a,u)})):r.resolve(h).then((function(t){s.value=t,a(s)}),(function(t){return e("throw",t,a,u)}))}u(c.arg)}var o;c(this,"_invoke",(function(t,n){function i(){return new r((function(r,o){e(t,n,r,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(r,e){var n=e.method,o=r.i[n];if(o===t)return e.delegate=null,"throw"===n&&r.i.return&&(e.method="return",e.arg=t,x(r,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=f(o,r.i,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,h;var a=i.arg;return a?a.done?(e[r.r]=a.value,e.next=r.n,"return"!==e.method&&(e.method="next",e.arg=t),e.delegate=null,h):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function E(t){this.tryEntries.push(t)}function k(r){var e=r[4]||{};e.type="normal",e.arg=t,r[4]=e}function S(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function O(r){if(null!=r){var e=r[i];if(e)return e.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,a=function e(){for(;++o<r.length;)if(n.call(r,o))return e.value=r[o],e.done=!1,e;return e.value=t,e.done=!0,e};return a.next=a}}throw new TypeError(K(r)+" is not iterable")}return p.prototype=d,c(m,"constructor",d),c(d,"constructor",p),p.displayName=c(d,u,"GeneratorFunction"),r.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===p||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,c(t,u,"GeneratorFunction")),t.prototype=Object.create(m),t},r.awrap=function(t){return{__await:t}},w(b.prototype),c(b.prototype,a,(function(){return this})),r.AsyncIterator=b,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new b(s(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(m),c(m,u,"Generator"),c(m,i,(function(){return this})),c(m,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var r=Object(t),e=[];for(var n in r)e.unshift(n);return function t(){for(;e.length;)if((n=e.pop())in r)return t.value=n,t.done=!1,t;return t.done=!0,t}},r.values=O,S.prototype={constructor:S,reset:function(r){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!r)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function n(t){a.type="throw",a.arg=r,e.next=t}for(var o=e.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,c=i[1],s=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!s)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<c)return this.method="next",this.arg=t,n(c),!0;if(u<s)return n(s),!1}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=r&&r<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=r,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),h},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e[2]===t)return this.complete(e[4],e[3]),k(e),h}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e[0]===t){var n=e[4];if("throw"===n.type){var o=n.arg;k(e)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,e,n){return this.delegate={i:O(r),r:e,n},"next"===this.method&&(this.arg=t),h}},r}function Q(t,r,e,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void e(t)}u.done?r(c):Promise.resolve(c).then(n,o)}function X(t){return function(){var r=this,e=arguments;return new Promise((function(n,o){var i=t.apply(r,e);function a(t){Q(i,n,o,a,u,"next",t)}function u(t){Q(i,n,o,a,u,"throw",t)}a(void 0)}))}}var Z=function(){var t=document.getElementById("loadingOverlay");t&&(t.style.display="none")},tt=!1;function rt(){return(rt=X(J().mark((function r(){var e,n,o,i,a,u;return J().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,t.getAllOfflineStories)();case 2:if((e=r.sent).length){r.next=5;break}return r.abrupt("return");case 5:n=$(e),r.prev=6,n.s();case 8:if((o=n.n()).done){r.next=25;break}if(i=o.value,r.prev=10,i.description&&(i.photo||i.photoUrl)){r.next=14;break}return console.warn("Lewati story offline yang datanya tidak lengkap:",i),r.abrupt("continue",23);case 14:return a=i.photo,u=new File([a],"offline-photo.jpg",{type:a.type||"image/jpeg"}),r.next=18,O(i.description,u,i.lat,i.lon);case 18:r.next=23;break;case 20:r.prev=20,r.t0=r.catch(10),console.error("Gagal sinkronisasi cerita offline:",r.t0);case 23:r.next=8;break;case 25:r.next=30;break;case 27:r.prev=27,r.t1=r.catch(6),n.e(r.t1);case 30:return r.prev=30,n.f(),r.finish(30);case 33:return r.next=35,(0,t.clearOfflineStories)();case 35:case"end":return r.stop()}}),r,null,[[6,27,30,33],[10,20]])})))).apply(this,arguments)}var et={getSavedStories:function(){return X(J().mark((function r(){return J().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,t.getAllOfflineStoryDetails)();case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}}),r)})))()},initStoryFormHandler:function(){tt||(tt=!0,document.addEventListener("submit",function(){var r=X(J().mark((function r(e){var n,o,i,a;return J().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!e.target.matches("#addStoryForm")){r.next=30;break}if(e.preventDefault(),n=e.target.description.value.trim(),o=e.target.photo.files[0],i=parseFloat(e.target.lat.value),a=parseFloat(e.target.lon.value),n&&o&&!isNaN(i)&&!isNaN(a)){r.next=9;break}return alert("Deskripsi, foto, dan lokasi wajib diisi."),r.abrupt("return");case 9:if(u=void 0,(u=document.getElementById("loadingOverlay"))&&(u.style.display="flex"),r.prev=10,navigator.onLine){r.next=17;break}return r.next=14,(0,t.saveStoryOffline)({description:n,photo:o,lat:i,lon:a});case 14:alert("Kamu sedang offline. Cerita disimpan dan akan dikirim saat online."),r.next=21;break;case 17:return r.next=19,O(n,o,i,a);case 19:alert("Cerita berhasil ditambahkan!"),window.location.hash="/";case 21:r.next=27;break;case 23:r.prev=23,r.t0=r.catch(10),console.error("Submit error:",r.t0),alert("Gagal menyimpan cerita.");case 27:return r.prev=27,Z(),r.finish(27);case 30:case"end":return r.stop()}var u}),r,null,[[10,23,27,30]])})));return function(t){return r.apply(this,arguments)}}()),window.addEventListener("online",(function(){console.log("Koneksi kembali! Sinkronisasi cerita offline..."),function(){rt.apply(this,arguments)}()})))}};function nt(t){return nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nt(t)}function ot(){ot=function(){return r};var t,r={},e=Object.prototype,n=e.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(t,r,e,n){return Object.defineProperty(t,r,{value:e,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(t){c=function(t,r,e){return t[r]=e}}function s(r,e,n,o){var i=e&&e.prototype instanceof l?e:l,a=Object.create(i.prototype);return c(a,"_invoke",function(r,e,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=x(u,n);if(c){if(c===h)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var s=f(r,e,n);if("normal"===s.type){if(o=n.done?4:2,s.arg===h)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=4,n.method="throw",n.arg=s.arg)}}}(r,n,new S(o||[])),!0),a}function f(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}r.wrap=s;var h={};function l(){}function p(){}function d(){}var y={};c(y,i,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(O([])));g&&g!==e&&n.call(g,i)&&(y=g);var m=d.prototype=l.prototype=Object.create(y);function w(t){["next","throw","return"].forEach((function(r){c(t,r,(function(t){return this._invoke(r,t)}))}))}function b(t,r){function e(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,h=s.value;return h&&"object"==nt(h)&&n.call(h,"__await")?r.resolve(h.__await).then((function(t){e("next",t,a,u)}),(function(t){e("throw",t,a,u)})):r.resolve(h).then((function(t){s.value=t,a(s)}),(function(t){return e("throw",t,a,u)}))}u(c.arg)}var o;c(this,"_invoke",(function(t,n){function i(){return new r((function(r,o){e(t,n,r,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(r,e){var n=e.method,o=r.i[n];if(o===t)return e.delegate=null,"throw"===n&&r.i.return&&(e.method="return",e.arg=t,x(r,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=f(o,r.i,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,h;var a=i.arg;return a?a.done?(e[r.r]=a.value,e.next=r.n,"return"!==e.method&&(e.method="next",e.arg=t),e.delegate=null,h):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function E(t){this.tryEntries.push(t)}function k(r){var e=r[4]||{};e.type="normal",e.arg=t,r[4]=e}function S(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function O(r){if(null!=r){var e=r[i];if(e)return e.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,a=function e(){for(;++o<r.length;)if(n.call(r,o))return e.value=r[o],e.done=!1,e;return e.value=t,e.done=!0,e};return a.next=a}}throw new TypeError(nt(r)+" is not iterable")}return p.prototype=d,c(m,"constructor",d),c(d,"constructor",p),p.displayName=c(d,u,"GeneratorFunction"),r.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===p||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,c(t,u,"GeneratorFunction")),t.prototype=Object.create(m),t},r.awrap=function(t){return{__await:t}},w(b.prototype),c(b.prototype,a,(function(){return this})),r.AsyncIterator=b,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new b(s(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(m),c(m,u,"Generator"),c(m,i,(function(){return this})),c(m,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var r=Object(t),e=[];for(var n in r)e.unshift(n);return function t(){for(;e.length;)if((n=e.pop())in r)return t.value=n,t.done=!1,t;return t.done=!0,t}},r.values=O,S.prototype={constructor:S,reset:function(r){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!r)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function n(t){a.type="throw",a.arg=r,e.next=t}for(var o=e.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,c=i[1],s=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!s)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<c)return this.method="next",this.arg=t,n(c),!0;if(u<s)return n(s),!1}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=r&&r<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=r,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),h},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e[2]===t)return this.complete(e[4],e[3]),k(e),h}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e[0]===t){var n=e[4];if("throw"===n.type){var o=n.arg;k(e)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,e,n){return this.delegate={i:O(r),r:e,n},"next"===this.method&&(this.arg=t),h}},r}function it(t,r,e,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void e(t)}u.done?r(c):Promise.resolve(c).then(n,o)}function at(t){return function(){var r=this,e=arguments;return new Promise((function(n,o){var i=t.apply(r,e);function a(t){it(i,n,o,a,u,"next",t)}function u(t){it(i,n,o,a,u,"throw",t)}a(void 0)}))}}function ut(t){return ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ut(t)}function ct(){ct=function(){return r};var t,r={},e=Object.prototype,n=e.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(t,r,e,n){return Object.defineProperty(t,r,{value:e,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(t){c=function(t,r,e){return t[r]=e}}function s(r,e,n,o){var i=e&&e.prototype instanceof l?e:l,a=Object.create(i.prototype);return c(a,"_invoke",function(r,e,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=x(u,n);if(c){if(c===h)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var s=f(r,e,n);if("normal"===s.type){if(o=n.done?4:2,s.arg===h)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=4,n.method="throw",n.arg=s.arg)}}}(r,n,new S(o||[])),!0),a}function f(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}r.wrap=s;var h={};function l(){}function p(){}function d(){}var y={};c(y,i,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(O([])));g&&g!==e&&n.call(g,i)&&(y=g);var m=d.prototype=l.prototype=Object.create(y);function w(t){["next","throw","return"].forEach((function(r){c(t,r,(function(t){return this._invoke(r,t)}))}))}function b(t,r){function e(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,h=s.value;return h&&"object"==ut(h)&&n.call(h,"__await")?r.resolve(h.__await).then((function(t){e("next",t,a,u)}),(function(t){e("throw",t,a,u)})):r.resolve(h).then((function(t){s.value=t,a(s)}),(function(t){return e("throw",t,a,u)}))}u(c.arg)}var o;c(this,"_invoke",(function(t,n){function i(){return new r((function(r,o){e(t,n,r,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(r,e){var n=e.method,o=r.i[n];if(o===t)return e.delegate=null,"throw"===n&&r.i.return&&(e.method="return",e.arg=t,x(r,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=f(o,r.i,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,h;var a=i.arg;return a?a.done?(e[r.r]=a.value,e.next=r.n,"return"!==e.method&&(e.method="next",e.arg=t),e.delegate=null,h):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function E(t){this.tryEntries.push(t)}function k(r){var e=r[4]||{};e.type="normal",e.arg=t,r[4]=e}function S(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function O(r){if(null!=r){var e=r[i];if(e)return e.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,a=function e(){for(;++o<r.length;)if(n.call(r,o))return e.value=r[o],e.done=!1,e;return e.value=t,e.done=!0,e};return a.next=a}}throw new TypeError(ut(r)+" is not iterable")}return p.prototype=d,c(m,"constructor",d),c(d,"constructor",p),p.displayName=c(d,u,"GeneratorFunction"),r.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===p||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,c(t,u,"GeneratorFunction")),t.prototype=Object.create(m),t},r.awrap=function(t){return{__await:t}},w(b.prototype),c(b.prototype,a,(function(){return this})),r.AsyncIterator=b,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new b(s(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(m),c(m,u,"Generator"),c(m,i,(function(){return this})),c(m,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var r=Object(t),e=[];for(var n in r)e.unshift(n);return function t(){for(;e.length;)if((n=e.pop())in r)return t.value=n,t.done=!1,t;return t.done=!0,t}},r.values=O,S.prototype={constructor:S,reset:function(r){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!r)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function n(t){a.type="throw",a.arg=r,e.next=t}for(var o=e.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,c=i[1],s=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!s)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<c)return this.method="next",this.arg=t,n(c),!0;if(u<s)return n(s),!1}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=r&&r<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=r,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),h},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e[2]===t)return this.complete(e[4],e[3]),k(e),h}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e[0]===t){var n=e[4];if("throw"===n.type){var o=n.arg;k(e)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,e,n){return this.delegate={i:O(r),r:e,n},"next"===this.method&&(this.arg=t),h}},r}function st(t,r,e,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void e(t)}u.done?r(c):Promise.resolve(c).then(n,o)}var ft={"/":f,"/add-story":function(){var t,r,e=null,n=null,o=function(){t&&(t.getTracks().forEach((function(t){return t.stop()})),console.log("Kamera dimatikan"))};return setTimeout(C(B().mark((function i(){var a,u,c,s,f,h,l;return B().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return a=document.getElementById("camera"),u=document.getElementById("photo-preview"),c=document.getElementById("take-photo"),s=document.getElementById("story-form"),i.prev=4,i.next=7,navigator.mediaDevices.getUserMedia({video:!0});case 7:t=i.sent,a.srcObject=t,i.next=14;break;case 11:i.prev=11,i.t0=i.catch(4),alert("Camera access failed: "+i.t0.message);case 14:c.addEventListener("click",(function(){u.width=360,u.height=360,u.getContext("2d").drawImage(a,0,0,u.width,u.height),u.style.display="block"})),(f=document.getElementById("map"))._leaflet_id||(h=L.map(f).setView([-6.2,106.8],10),L.tileLayer("https://api.maptiler.com/maps/basic/{z}/{x}/{y}.png?key=7BXPo4DtwET5hku94tQR",{attribution:"&copy; OpenStreetMap contributors"}).addTo(h),h.on("click",(function(t){e=t.latlng.lat,n=t.latlng.lng,document.getElementById("lat").innerText=e.toFixed(5),document.getElementById("lon").innerText=n.toFixed(5),l&&h.removeLayer(l),l=L.marker([e,n]).addTo(h)}))),document.getElementById("back-button").addEventListener("click",(function(){o(),window.location.hash="/"})),window.addEventListener("hashchange",o),r=function(){var t=C(B().mark((function t(i){var a,c;return B().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i.preventDefault(),a=document.getElementById("description").value,t.next=4,new Promise((function(t){u.toBlob((function(r){return t(r)}),"image/jpeg")}));case 4:if(c=t.sent,a&&c&&null!==e&&null!==n){t.next=8;break}return alert("Deskripsi, foto, dan lokasi wajib diisi."),t.abrupt("return");case 8:return t.prev=8,t.next=11,F({description:a,photo:c,lat:e,lon:n});case 11:t.sent.offline?alert("Kamu sedang offline. Cerita disimpan dan akan dikirim saat online."):alert("Anda telah membuat story baru dengan deskripsi: ".concat(a)),o(),window.removeEventListener("hashchange",o),s.removeEventListener("submit",r),window.location.hash="#/",t.next=23;break;case 19:t.prev=19,t.t0=t.catch(8),alert("Gagal menambahkan story: "+t.t0.message),s.removeEventListener("submit",r);case 23:case"end":return t.stop()}}),t,null,[[8,19]])})));return function(r){return t.apply(this,arguments)}}(),s.removeEventListener("submit",r),s.addEventListener("submit",r),I();case 23:case"end":return i.stop()}}),i,null,[[4,11]])}))),0),'\n        <div class="add-story-container">\n            <h2>Add a New Story</h2>\n            <form id="story-form" class="fade-in">\n                <label for="description">Description</label>\n                <textarea id="description" name="description" placeholder="Describe your story..." required></textarea>\n\n                <div class="photo-section">\n                    <label>Take a Photo</label>\n                    <video id="camera" autoplay playsinline style="width: 100%; max-width: 300px;"></video>\n                    <button type="button" id="take-photo">Take Photo</button>\n                    <canvas id="photo-preview" style="display:none;"></canvas>\n                </div>\n\n                <div class="map-section">\n                    <label>Select Location</label>\n                    <div id="map" style="height: 300px;"></div>\n                    <p>Latitude: <span id="lat">-</span>, Longitude: <span id="lon">-</span></p>\n                </div>\n\n                <div class="button-group">\n                    <button type="button" id="back-button">← Kembali ke Konten Utama</button>\n                    <button type="submit">Submit</button>\n                </div>\n            </form>\n        </div>\n    '},"/login":function(){return'\n        <div class="centered-container">\n            <form id="loginForm">\n                <h2 style="text-align:center;">Login</h2>\n                <label>Email</label>\n                <input type="email" name="email" required>\n\n                <label>Password</label>\n                <input type="password" name="password" required>\n\n                <button type="submit">Login</button>\n                <p style="text-align:center;">Don\'t have an account? <a href="#/register">Register</a></p>\n            </form>\n        </div>\n    '},"/register":function(){return'\n        <div class="centered-container">\n            <form id="registerForm">\n                <h2 style="text-align:center;">Register</h2>\n                <label>Name</label>\n                <input type="text" name="name" required>\n\n                <label>Email</label>\n                <input type="email" name="email" required>\n\n                <label>Password</label>\n                <input type="password" name="password" required>\n\n                <button type="submit">Register</button>\n                <p style="text-align:center;">Already have an account? <a href="#/login">Login</a></p>\n            </form>\n        </div>\n    '},"/story/:id":W,"/story-tersimpan":function(){var t=at(ot().mark((function t(){var r,e,n;return ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,et.getSavedStories();case 2:if(t.t0=t.sent,t.t0){t.next=5;break}t.t0=[];case 5:return r=t.t0,e='\n    <h2 class="fade-in">Story Tersimpan</h2>\n    <div class="home-buttons fade-in">\n        <button id="home-button" class="fade-in">Kembali ke Home</button>\n    </div>\n    <div id="stories-list" class="fade-in">\n        '.concat(r.map((function(t,r){var e=t.photoUrl?t.photoUrl:t.photo instanceof File?URL.createObjectURL(t.photo):"string"==typeof t.photo&&t.photo.startsWith("data:image/")?t.photo:"https://via.placeholder.com/300x200?text=No+Image",n=t.createdAt?new Date(t.createdAt).toLocaleDateString():"Offline Story",o="map-".concat(t.id||"offline-".concat(r));return'\n                <div class="story-item fade-in">\n                    <img src="'.concat(e,'" alt="Foto cerita: ').concat(t.description,'">\n                    <p>').concat(t.description,"</p>\n                    <p><strong>Location:</strong> ").concat(t.lat||"-",", ").concat(t.lon||"-","</p>\n                    <p><strong>Created At:</strong> ").concat(n,'</p>\n                    <div id="').concat(o,'" class="story-map" style="height: 300px;"></div>\n                    <button class="bookmark-button" data-id="').concat(t.id,'">🗑 Buang</button>\n                </div>\n            ')})).join(""),"\n    </div>\n  "),(n=document.getElementById("home-container"))&&(n.innerHTML=e),setTimeout((function(){var t=document.getElementById("home-button");t&&t.addEventListener("click",(function(){window.location.hash="/"})),document.querySelectorAll(".bookmark-button").forEach((function(t){t.addEventListener("click",function(){var e=at(ot().mark((function e(n){var o,i,a;return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=t.dataset.id,i=r.find((function(t){return t.id==o}))){e.next=4;break}return e.abrupt("return");case 4:return e.prev=4,e.next=7,et.toggleBookmark(i);case 7:a=e.sent,t.textContent=a?"Buang":"Simpan",alert("Story dibuang dari penyimpanan offline."),window.location.reload(),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(4),console.error("Gagal hapus bookmark:",e.t0),alert("Terjadi kesalahan saat membuang bookmark.");case 17:case"end":return e.stop()}}),e,null,[[4,13]])})));return function(t){return e.apply(this,arguments)}}())}))}),0),setTimeout((function(){r.forEach((function(t,r){var e=t.lat,n=t.lon;if(e&&n){var o=document.getElementById("map-".concat(t.id||"offline-".concat(r)));if(o&&!o._leaflet_id){var i=L.map(o).setView([e,n],15);L.tileLayer("https://api.maptiler.com/maps/basic/{z}/{x}/{y}.png?key=7BXPo4DtwET5hku94tQR",{attribution:"&copy; OpenStreetMap contributors"}).addTo(i);var a=t.photoUrl?t.photoUrl:t.photo instanceof File?URL.createObjectURL(t.photo):"string"==typeof t.photo&&t.photo.startsWith("data:image/")?t.photo:"";L.marker([e,n]).addTo(i).bindPopup('\n          <div style="font-size: 11px; max-width: 150px; padding: 5px; line-height: 1.3;">\n              <strong>'.concat(t.description,"</strong><br>\n              ").concat(a?'<img src="'.concat(a,'" alt="Foto cerita" style="width: 100%; height: auto; border-radius: 4px; margin-top: 4px;">'):"",'\n              <span style="color: #555;">').concat(e,", ").concat(n,"</span>\n          </div>\n        ")).openPopup()}}}))}),0),t.abrupt("return",e);case 12:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},ht=function(){var t,r=(t=ct().mark((function t(){var r,e,n,o;return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=window.location.hash.slice(1)||"/",!(e=r.match(/^\/story\/(.+)$/))){t.next=8;break}return t.next=5,W(e[1]);case 5:n=t.sent,t.next=12;break;case 8:return o=ft[r]||f,t.next=11,o();case 11:n=t.sent;case 12:document.getElementById("app").innerHTML=n;case 13:case"end":return t.stop()}}),t)})),function(){var r=this,e=arguments;return new Promise((function(n,o){var i=t.apply(r,e);function a(t){st(i,n,o,a,u,"next",t)}function u(t){st(i,n,o,a,u,"throw",t)}a(void 0)}))});return function(){return r.apply(this,arguments)}}();function lt(t){return lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lt(t)}function pt(){pt=function(){return r};var t,r={},e=Object.prototype,n=e.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(t,r,e,n){return Object.defineProperty(t,r,{value:e,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(t){c=function(t,r,e){return t[r]=e}}function s(r,e,n,o){var i=e&&e.prototype instanceof l?e:l,a=Object.create(i.prototype);return c(a,"_invoke",function(r,e,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=x(u,n);if(c){if(c===h)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var s=f(r,e,n);if("normal"===s.type){if(o=n.done?4:2,s.arg===h)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=4,n.method="throw",n.arg=s.arg)}}}(r,n,new S(o||[])),!0),a}function f(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}r.wrap=s;var h={};function l(){}function p(){}function d(){}var y={};c(y,i,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(O([])));g&&g!==e&&n.call(g,i)&&(y=g);var m=d.prototype=l.prototype=Object.create(y);function w(t){["next","throw","return"].forEach((function(r){c(t,r,(function(t){return this._invoke(r,t)}))}))}function b(t,r){function e(o,i,a,u){var c=f(t[o],t,i);if("throw"!==c.type){var s=c.arg,h=s.value;return h&&"object"==lt(h)&&n.call(h,"__await")?r.resolve(h.__await).then((function(t){e("next",t,a,u)}),(function(t){e("throw",t,a,u)})):r.resolve(h).then((function(t){s.value=t,a(s)}),(function(t){return e("throw",t,a,u)}))}u(c.arg)}var o;c(this,"_invoke",(function(t,n){function i(){return new r((function(r,o){e(t,n,r,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(r,e){var n=e.method,o=r.i[n];if(o===t)return e.delegate=null,"throw"===n&&r.i.return&&(e.method="return",e.arg=t,x(r,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=f(o,r.i,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,h;var a=i.arg;return a?a.done?(e[r.r]=a.value,e.next=r.n,"return"!==e.method&&(e.method="next",e.arg=t),e.delegate=null,h):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function E(t){this.tryEntries.push(t)}function k(r){var e=r[4]||{};e.type="normal",e.arg=t,r[4]=e}function S(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function O(r){if(null!=r){var e=r[i];if(e)return e.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,a=function e(){for(;++o<r.length;)if(n.call(r,o))return e.value=r[o],e.done=!1,e;return e.value=t,e.done=!0,e};return a.next=a}}throw new TypeError(lt(r)+" is not iterable")}return p.prototype=d,c(m,"constructor",d),c(d,"constructor",p),p.displayName=c(d,u,"GeneratorFunction"),r.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===p||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,c(t,u,"GeneratorFunction")),t.prototype=Object.create(m),t},r.awrap=function(t){return{__await:t}},w(b.prototype),c(b.prototype,a,(function(){return this})),r.AsyncIterator=b,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new b(s(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(m),c(m,u,"Generator"),c(m,i,(function(){return this})),c(m,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var r=Object(t),e=[];for(var n in r)e.unshift(n);return function t(){for(;e.length;)if((n=e.pop())in r)return t.value=n,t.done=!1,t;return t.done=!0,t}},r.values=O,S.prototype={constructor:S,reset:function(r){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!r)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function n(t){a.type="throw",a.arg=r,e.next=t}for(var o=e.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,c=i[1],s=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!s)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<c)return this.method="next",this.arg=t,n(c),!0;if(u<s)return n(s),!1}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=r&&r<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=r,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),h},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e[2]===t)return this.complete(e[4],e[3]),k(e),h}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e[0]===t){var n=e[4];if("throw"===n.type){var o=n.arg;k(e)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,e,n){return this.delegate={i:O(r),r:e,n},"next"===this.method&&(this.arg=t),h}},r}function dt(t,r,e,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void e(t)}u.done?r(c):Promise.resolve(c).then(n,o)}window.addEventListener("hashchange",ht);var yt=function(){var t=document.getElementById("loadingOverlay");t&&(t.style.display="flex")},vt=function(){var t=document.getElementById("loadingOverlay");t&&(t.style.display="none")},gt=function(){document.addEventListener("submit",function(){var t,r=(t=pt().mark((function t(r){var e,n,o,i,a,u;return pt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!r.target.matches("#loginForm")){t.next=23;break}if(r.preventDefault(),e=r.target.email.value.trim(),n=r.target.password.value.trim(),e&&n){t.next=7;break}return alert("Email dan password tidak boleh kosong."),t.abrupt("return");case 7:return t.prev=7,yt(),t.next=11,S(e,n);case 11:o=t.sent,localStorage.setItem("token",o.token),alert("Login Berhasil"),window.location.hash="/",t.next=20;break;case 17:t.prev=17,t.t0=t.catch(7),alert("Login gagal: "+t.t0.message);case 20:return t.prev=20,vt(),t.finish(20);case 23:if(!r.target.matches("#registerForm")){t.next=48;break}if(r.preventDefault(),i=r.target.name.value.trim(),a=r.target.email.value.trim(),u=r.target.password.value.trim(),i&&a&&u){t.next=31;break}return alert("Semua field wajib diisi."),t.abrupt("return");case 31:if(!(u.length<8)){t.next=34;break}return alert("Password must be at least 8 characters long."),t.abrupt("return");case 34:return t.prev=34,yt(),t.next=38,k(i,a,u);case 38:alert("Registrasi berhasil! Silakan login."),window.location.hash="/login",t.next=45;break;case 42:t.prev=42,t.t1=t.catch(34),alert("Registrasi gagal: "+t.t1.message);case 45:return t.prev=45,vt(),t.finish(45);case 48:case"end":return t.stop()}}),t,null,[[7,17,20,23],[34,42,45,48]])})),function(){var r=this,e=arguments;return new Promise((function(n,o){var i=t.apply(r,e);function a(t){dt(i,n,o,a,u,"next",t)}function u(t){dt(i,n,o,a,u,"throw",t)}a(void 0)}))});return function(t){return r.apply(this,arguments)}}())},mt=o(72),wt=o.n(mt),bt=o(825),xt=o.n(bt),Et=o(659),kt=o.n(Et),St=o(56),Ot=o.n(St),jt=o(540),_t=o.n(jt),Pt=o(113),Tt=o.n(Pt),Gt=o(276),Nt={};Nt.styleTagTransform=Tt(),Nt.setAttributes=Ot(),Nt.insert=kt().bind(null,"head"),Nt.domAPI=xt(),Nt.insertStyleElement=_t();wt()(Gt.A,Nt);Gt.A&&Gt.A.locals&&Gt.A.locals;o(518);document.addEventListener("DOMContentLoaded",(function(){var t=localStorage.getItem("token");window.location.hash=t?"/":"/login",ht(),gt(),et.initStoryFormHandler()}))})()})();